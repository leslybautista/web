<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <title>Democracy Storymap</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="https://unpkg.com/maplibre-gl@2.4.0/dist/maplibre-gl.css" rel="stylesheet" />
  <script src="https://unpkg.com/maplibre-gl@2.4.0/dist/maplibre-gl.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@turf/turf@6.5.0/turf.min.js"></script>
  <link rel="stylesheet" href="style.css">
  

  <style>
    html,
    body {
      margin: 0;
      padding: 0;
      font-family: "Helvetica Neue", sans-serif;
      height: 100%;
      color: #e7e7e7;

      overflow: hidden;
    }

    #map {
      position: fixed;
      top: 55px;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 1;
    }

    .story-container {
      margin-top: 20px;
      position: relative;
      z-index: 2;
      height: 100%;
      width: 45%;
      max-width: 700px;
      background: rgba(0, 0, 0, 0.9);
      overflow: hidden;
      display: flex;
      flex-direction: column;
      justify-content: center;
      padding: 2rem;
      box-shadow: 4px 0 12px rgba(0, 0, 0, 0.1);
    }

    .slide {
      display: none;
      flex-direction: column;
    }

    .slide.active {
      display: flex;
    }

    .slide h1 {
      margin-top: 0;
      font-size: 60px;
      color: #f1f1f1;
    }

    .slide h2 {
      margin-top: 0;
      font-size: 2rem;
      color: #f1f1f1;
    }

    .slide p {
      color: #f1f1f1;
      line-height: 1.6;
    }
    .slide a {
      color: #5e3ea1;
      text-decoration: underline;
    }


    .legend {
      position: absolute;
      bottom: 20px;
      right: 20px;
      background: white;
      padding: 10px;
      font-size: 14px;
      border-radius: 5px;
      box-shadow: 0 1px 4px rgba(0, 0, 0, 0.2);
      z-index: 3;
    }

    .legend-item {
      display: flex;
      align-items: center;
      margin-bottom: 4px;
      color: black;
      z-index: 5;
    }

    .color-box {
      width: 15px;
      height: 15px;
      margin-right: 8px;
      display: inline-block;
    }

    .liberal {
      background-color: #756e91;
    }

    .electoral-democracy {
      background-color: #b0b1cb;
    }

    .ed-lower-bound {
      background-color: #DEBFD0;
    }

    .ea-upper-bound {
      background-color: #D7BDA0;
    }

    .electoral-autocracy {
      background-color: #E1907D;
    }

    .closed-autocracy {
      background-color: #ac4f3b;
    }

    @media (max-width: 768px) {
      .story-container {
        width: 100%;
      }
    }
  </style>
</head>

<body>
  <nav class="navbar">
    <div class="nav-container">
      <a href="#" class="logo">Democratization vs. Autocratization</a>
      <ul class="nav-menu">
        <li><a href="index.html" class="nav-link">Home</a></li>
        <li><a href="overview.html" class="nav-link">Overview</a></li>
        <li><a href="europe.html" class="nav-link">Europe</a></li>
        <li><a href="north.html" class="nav-link">North America</a></li>
        <li><a href="south.html" class="nav-link active">South America</a></li>
        <li><a href="asia.html" class="nav-link">Asia</a></li>
        <li><a href="africa.html" class="nav-link">Africa</a></li>
        <li><a href="map.html" class="nav-link">Map</a></li>
        <li><a href="globe.html" class="nav-link">Globe</a></li>
      </ul>
      <button class="mobile-menu-toggle">☰</button>
    </div>
  </nav>

  <div id="map"></div>

  <div class="story-container" id="story">
    <div class="slide active" data-country="Global">
      <h1>South America</h1>
      <p>The state of democracy in South America is a complex and evolving situation. While democracy is the dominant
        form of government in the region, many countries are facing challenges, including declining public support,
        democratic erosion, and the rise of authoritarianism in some cases. <a href="https://www.v-dem.net/"
          class="source">(V-dem, 2024)</a></p>
    </div>
    <div class="slide active" data-country="Peru">
      <h2>Peru</h2>
      <h3>
        <a href="https://rpp.pe/politica/elecciones/mas-de-13-millones-de-jovenes-votaran-en-2026-lo-que-opinan-de-la-democracia-y-de-la-forma-de-hacer-politica-de-los-partidos-noticia-1623215"
          target="_blank">
          A Dangerous Drift Away from Democracy </a>
      </h3>
      <p>
        Experts warn that when democracies fail to deliver, particularly to young people, authoritarian alternatives
        can start to appear more appealing. Political scientist Franco Olcese emphasized: <br>
        <em>“When democratic institutions and political parties lose legitimacy, authoritarian options—where power is
          concentrated and citizens have no control—start to look more attractive. It's not only dangerous when young
          people lose faith in democracy; it's dangerous when society as a whole does.” </em>
      </p>

      <!-- Contenedor para imagen y texto en línea -->
      <div style="display: flex; align-items: flex-start; gap: 10px; margin-top: 15px;">
        <img src="media/park2.jpg" alt="Peru" style="width: 30%; height: auto;">
        <p style="margin: 0;">
          From Cajamarca, analyst Gianfranco Vigo added: <em>“If you take away young people’s dream and hope, who will take the reins of the country’s future? We’re already seeing a major brain drain, and those who stay are increasingly exposed to radical ideas.”</em>
        </p>
      </div>
    </div>
    <div class="slide" data-country="Guyana">
      <h2>Guyana</h2>
      <h3>
        <a href="https://www.thetimes.com/world/latin-america/article/welcome-to-the-suddenly-rich-nation-thats-giving-every-voter-300-ghzz62gpd?utm_source=chatgpt.com&region=global" target="_blank">
          Oil Boom and Democracy Erosion</a>
      </h3>
      <p>
        Guyana is experiencing a significant oil boom, which has led to concerns about the erosion of democracy in the
        country. The rapid influx of oil wealth has created opportunities for corruption and has raised questions about
        the government's commitment to democratic principles.</p>
        <div style="display: flex; align-items: flex-start; gap: 10px; margin-top: 15px;">
        <img src="media/park1.jpg" alt="guyana" style="width: 40%; height: auto;">
        <p style="margin: 0;">
          The Liberty and Democracy Group, made up of former presidents from Latin America and Spain, has condemned Venezuela’s military incursion into Guyanese waters as a deliberate attempt by Nicolás Maduro’s authoritarian regime to undermine regional stability and international law. </p>
        </p>
      </div>
    </div>
    <div class="slide" data-country="Argentina">
      <h2>Argentina</h2>
      <h3>
        <a href="https://www.elobservador.com.uy/argentina/politica/un-informe-internacional-advierte-que-argentina-esta-proceso-convertirse-una-autocracia-n5991879?utm_source=chatgpt.com" target="_blank">
           Democratic Challenges Under President Milei</a>
      </h3>
      <p>
        President Javier Milei's administration has faced criticism for actions perceived as undermining democratic institutions. The use of decrees to implement significant policy changes without legislative approval has raised concerns about the balance of power.
        <br>Additionally, the government's confrontational stance toward the media, has been condemned by press freedom organizations. Such actions contribute to a climate of polarization and pose risks to democratic discourse.
      </p>
      <div style="display: flex; align-items: flex-start; gap: 10px; margin-top: 15px;">
        <img src="media/milei.jpg" alt="Milei" style="width: 30%; height: auto;">
        <p style="margin: 0;">
          In a recent interview, Milei stated: <em>"I am not a dictator, I am a libertarian. I believe in the power of the people to make their own choices."</em> However, many remain skeptical about his commitment to democratic principles.
        </p>
      </div>
    </div>

    <div class="slide" data-country="Bolivia">
      <h2>Bolivia</h2>
      <h3>
        <a href="https://elpais.com/america/2025-05-03/balon-de-oxigeno-para-la-izquierda-boliviana-andronico-rodriguez-considerado-delfin-de-evo-morales-acepta-ser-candidato.html?utm_source=chatgpt.com" target="_blank">
          Electoral Landscape and Political Fragmentation</a>
      </h3>
      <div style="display: flex; align-items: flex-start; gap: 10px; margin-top: 15px;">
        <img src="media/evo.jpg" alt="evo" style="width: 25%; height: auto;">
        <p style="margin: 0;">
         The upcoming general election scheduled for August 2025 is set against a backdrop of unprecedented political fragmentation. Thirteen candidates have registered, reflecting a fractured political environment. The ruling Movement for Socialism (MAS) party is divided between President Luis Arce and former President Evo Morales.  </p>
      </div>
      <p> <br> Morales, barred from running due to term limits, has endorsed Andrónico Rodríguez, who has announced his candidacy, potentially using another party's platform due to internal conflicts. The judiciary's role in barring Morales from candidacy has been contentious, with accusations of political motivations behind legal decisions</p>
    </div>
    <div class="slide" data-country="Paraguay">
      <h2>Paraguay</h2>
      <h3>
        <a href="https://www.ultimahora.com/la-lucha-contra-las-desigualdades-es-mas-compleja-que-por-la-democracia-el-consultor-en-campanas-de-comunicacion-analiza-el-panorama-politico-y-electoral-en-paraguay-asi-como-la-creciente-amenaza-del-crimen-organizado-contra-las-democracias-de-la-region-y-el-mundo" target="_blank">
        Institutional Continuity and Political Dominance</a> </h3>
      <p>Paraguay's democracy exhibits a complex interplay of institutional continuity, political dominance, and emerging challenges to civil liberties. While Paraguay maintains formal democratic structures, challenges such as concentrated political power, restrictions on civil liberties, and persistent corruption pose significant threats to the health of its democracy.</p>
      <div style="display: flex; align-items: flex-start; gap: 10px; margin-top: 15px;">
        <img src="media/paraguay.jpg" alt="paraguay" style="width: 25%; height: auto;">
        <p style="margin: 0;">
        Corruption remains a pervasive issue, undermining public trust in institutions. Efforts to combat corruption have been met with skepticism, particularly regarding the effectiveness of newly established anti-corruption bodies and the exclusion of certain sectors from oversight. </p>
      </div>
      
    </div>
  </div>

  <div class="legend">
    <div class="legend-item"><span class="color-box liberal"></span> Liberal democracy</div>
    <div class="legend-item"><span class="color-box electoral-democracy"></span> Electoral democracy</div>
    <div class="legend-item"><span class="color-box ed-lower-bound"></span> Electoral dem. Lower Bound</div>
    <div class="legend-item"><span class="color-box ea-upper-bound"></span> Electoral Aut. Upper Bound</div>
    <div class="legend-item"><span class="color-box electoral-autocracy"></span> Electoral autocracy</div>
    <div class="legend-item"><span class="color-box closed-autocracy"></span> Closed autocracy</div>
  </div>

  <script src="mobile_menu_toggle.js"></script>
  <script>
    const map = new maplibregl.Map({
      container: 'map',
      style: {
        version: 8,
        sources: {
          'raster-tiles': {
            type: 'raster',
            tiles: [
              'https://a.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png'],
            tileSize: 256,
            attribution: '© OpenStreetMap contributors, © CartoDB'
          }
        },
        layers: [
          {
            id: 'simple-tiles',
            type: 'raster',
            source: 'raster-tiles',
            minzoom: 0,
            maxzoom: 20
          }
        ]
      },
      center: [-50, -15],    // center on South America
      zoom: 1.0              // zoom level showing South America nicely
    });
    const southAmericaBBox = [-82, -50, -10, 60]; // [west, south, east, north]


    // Add zoom and rotation controls to the map.
    map.addControl(new maplibregl.NavigationControl({
      visualizePitch: true,
      visualizeRoll: true,
      showZoom: true,
      showCompass: true
    }));

    let geoData = null;
    let currentIndex = 0;
    const slides = document.querySelectorAll('.slide');

    map.on('load', () => {
      fetch('data/democracy.geojson')
        .then(res => res.json())
        .then(data => {
          geoData = data;

          map.addSource('democracy', {
            type: 'geojson',
            data: geoData
          });

          map.addLayer({
            id: 'country-fill',
            type: 'fill',
            source: 'democracy',
            paint: {
              'fill-color': [
                'match', ['get', 'Democracy_'],
                'LD', '#756e91',
                'LD-', '#756e91',
                'ED', '#b0b1cb',
                'ED+', '#b0b1cb',
                'ED-', '#DEBFD0',
                'EA+', '#D7BDA0',
                'EA', '#bd7262',
                'CA', '#ac4f3b',
                '#e6e3e3' // default color for other values
              ],
              'fill-opacity': 0.9
            }
          });

          map.addLayer({
            id: 'country-border',
            type: 'line',
            source: 'democracy',
            paint: {
              'line-color': '#e6e6e6',
              'line-width': 0.5
            }
          });

          map.addLayer({
            id: 'highlight',
            type: 'line',
            source: 'democracy',
            paint: {
              'line-color': '#e6e6e6',
              'line-width': 4
            },
            filter: ['==', 'COUNTRY', '']
          });

          updateSlide(0);
        });
    });


    function updateSlide(index) {
      if (!geoData || index < 0 || index >= slides.length) return;

      slides.forEach((slide, i) => {
        slide.classList.toggle('active', i === index);
      });

      const country = slides[index].dataset.country;
      currentIndex = index;

      // If it's the "Global" slide, show South America bounding box & clear highlight
      if (country === "Global") {
        const southAmericaBBox = [-65, -55, -30, 5];
        const containerWidth = document.getElementById('story').clientWidth;
        const offsetX = containerWidth / 4;
        const offsetY = 0;

        map.setFilter('highlight', ['==', 'COUNTRY', '']); // clear highlight

        map.fitBounds(southAmericaBBox, {
          padding: 100,
          duration: 1200,
          offset: [offsetX, offsetY]
        });
        return;
      }

      // For other countries: highlight and zoom to the country polygon
      map.setFilter('highlight', ['==', 'COUNTRY', country]);

      const feature = geoData.features.find(f => f.properties.COUNTRY === country);
      if (!feature || !feature.geometry) {
        console.warn("Country not found in geoData:", country);
        return;
      }

      try {
        const bbox = turf.bbox(feature);

        const containerWidth = document.getElementById('story').clientWidth;
        const offsetX = -20+ containerWidth / 4;
        const offsetY = 0;

        map.fitBounds(bbox, {
          padding: 100,
          duration: 1200,
          offset: [offsetX, offsetY]
        });
      } catch (err) {
        console.warn('Could not fly to', country, err);
      }
    }


    document.addEventListener('keydown', (e) => {
      if (e.key === 'ArrowDown') {
        e.preventDefault();
        updateSlide(currentIndex + 1);
      } else if (e.key === 'ArrowUp') {
        e.preventDefault();
        updateSlide(currentIndex - 1);
      }
    });
  </script>
</body>

</html>