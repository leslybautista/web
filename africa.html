<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <title>Democracy Storymap</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="https://unpkg.com/maplibre-gl@2.4.0/dist/maplibre-gl.css" rel="stylesheet" />
  <script src="https://unpkg.com/maplibre-gl@2.4.0/dist/maplibre-gl.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@turf/turf@6.5.0/turf.min.js"></script>
  <link rel="stylesheet" href="style.css">

  <style>
    html,
    body {
      margin: 0;
      padding: 0;
      font-family: "Helvetica Neue", sans-serif;
      height: 100%;
      color: #e7e7e7;

      overflow: hidden;
    }

    #map {
      position: fixed;
      top: 55px;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 1;
    }

    .story-container {
      margin-top: 20px;
      position: relative;
      z-index: 2;
      height: 100%;
      width: 45%;
      max-width: 700px;
      background: rgba(0, 0, 0, 0.9);
      overflow: hidden;
      display: flex;
      flex-direction: column;
      justify-content: center;
      padding: 2rem;
      box-shadow: 4px 0 12px rgba(0, 0, 0, 0.1);
    }

    .slide {
      display: none;
      flex-direction: column;
    }

    .slide.active {
      display: flex;
    }

    .slide h1 {
      margin-top: 0;
      font-size: 60px;
      color: #f1f1f1;
    }

    .slide h2 {
      margin-top: 0;
      font-size: 2rem;
      color: #f1f1f1;
    }

    .slide p {
      color: #f1f1f1;
      line-height: 1.6;
    }
    .slide a {
      color: #5e3ea1;
      text-decoration: underline;
    }


    .legend {
      position: absolute;
      bottom: 20px;
      right: 20px;
      background: white;
      padding: 10px;
      font-size: 14px;
      border-radius: 5px;
      box-shadow: 0 1px 4px rgba(0, 0, 0, 0.2);
      z-index: 3;
    }

    .legend-item {
      display: flex;
      align-items: center;
      margin-bottom: 4px;
      color: black;
      z-index: 5;
    }

    .color-box {
      width: 15px;
      height: 15px;
      margin-right: 8px;
      display: inline-block;
    }

    .liberal {
      background-color: #756e91;
    }

    .electoral-democracy {
      background-color: #b0b1cb;
    }

    .ed-lower-bound {
      background-color: #DEBFD0;
    }

    .ea-upper-bound {
      background-color: #D7BDA0;
    }

    .electoral-autocracy {
      background-color: #E1907D;
    }

    .closed-autocracy {
      background-color: #ac4f3b;
    }

    @media (max-width: 768px) {
      .story-container {
        width: 100%;
      }
    }
  </style>
</head>

<body>
  <nav class="navbar">
    <div class="nav-container">
      <a href="#" class="logo">Democratization vs. Autocratization</a>
      <ul class="nav-menu">
        <li><a href="index.html" class="nav-link">Home</a></li>
        <li><a href="europe.html" class="nav-link">Europe</a></li>
        <li><a href="north.html" class="nav-link">North America</a></li>
        <li><a href="south.html" class="nav-link ">South America</a></li>
        <li><a href="asia.html" class="nav-link">Asia</a></li>
        <li><a href="africa.html" class="nav-link active">Africa</a></li>
        <li><a href="map.html" class="nav-link">Map</a></li>
      </ul>
      <button class="mobile-menu-toggle">☰</button>
    </div>
  </nav>

  <div id="map"></div>

  <div class="story-container" id="story">
    <div class="slide active" data-country="Global">
      <h2>Africa</h2>
      <p>Democracy in Africa is facing a pivotal moment in 2025, marked by troubling autocratic trends and encouraging democratic resilience. Across the continent, several governments have drifted toward authoritarianism, while others have demonstrated promising signs of reform and popular engagement. As Africa navigates 2025, its democratic landscape is neither wholly bleak nor unassailably secure. The continent stands at an inflection point: entrenched rulers deploying legal and constitutional tools to stifle dissent, counterbalanced by an invigorated citizenry demanding real representation. <a href="https://www.v-dem.net/"
          class="source">(V-dem, 2024)</a></p>
    </div>
    <div class="slide" data-country="South Africa">
      <h2>South Africa</h2>
      <h3>
        <a href="https://democracyinafrica.org/winds-of-change-or-stalemate-democracy-and-governance-trends-across-africa-in-2024/"
          target="_blank">
          Winds of Change or Stalemate? South Africa: Entering a New Era</a>
      </h3>
      <p>The core tension in African democracy today lies between growing authoritarian tendencies among 
        incumbents and an increasingly mobilised citizenry demanding transparency, justice, and representation.
        The direction of democracy in Africa remains uncertain, but far from static. Meanwhile, civic 
        engagement is surging among youth across the continent. From Nigeria to Kenya, protests, judicial 
        challenges, and digital activism are pushing for accountability despite state suppression. 
        In South Africa, the African National Congress (ANC) lost its parliamentary majority for the first 
        time since apartheid, necessitating coalition governance and indicating a shift towards greater 
        political pluralism.
      </p>

      <!-- Contenedor para imagen y texto en línea -->
      <div style="display: flex; align-items: flex-start; gap: 10px; margin-top: 15px;">
        <img src="media/south.png" alt="South Africa" style="width: 60%; height: auto;">
      </div>
      <p style="margin: 0;">
          Helen Zille, Chairperson of the Democratic Alliance: <em>“The ANC has to come apart.”</em>
        </p>
    </div>
    <div class="slide" data-country="Zambia">
      <h2>Zambia</h2>
      <h3>
        <a href="https://www.bloomberg.com/opinion/articles/2023-03-28/debt-restructuring-is-no-recipe-for-democracy-says-zambia-president-hichilema" target="_blank">
          Democratic Recovery</a>
      </h3>
      <p>
        In a striking reversal of fortunes, Zambia’s 2021 election brought into office Hakainde Hichilema, a long-time opposition leader who had spent time in jail on dubious charges. His victory—cheered both domestically and abroad—ended years of creeping executive overreach and media intimidation.</p>
        <div style="display: flex; align-items: flex-start; gap: 10px; margin-top: 15px;">
        <img src="media/zambia.png" alt="zambia" style="width: 40%; height: auto;">
        <p style="margin: 0;">
          Hichilema’s blunt assessment reflects the central challenge: <i>“You cannot eat democracy,”</i> he quipped, underscoring that political freedoms must translate into improved livelihoods. </p>
        </p>
      </div>
    </div>
    <div class="slide" data-country="Kenya">
      <h2>Kenya</h2>
      <h3>
        <a href="https://www.aljazeera.com/opinions/2017/9/2/why-did-kenyas-supreme-court-annul-the-elections" target="_blank">
           Kenya: Courts as Guardians</a>
      </h3>
      <p>
        Kenya’s judiciary has emerged as a crucial bulwark. In 2017, the Supreme Court annulled a presidential vote amid credible evidence of irregularities—the first time an African high court had done so. The ruling, and the court’s readiness to uphold constitutional checks, restored public faith in legal remedies.
      </p>
      <div style="display: flex; align-items: flex-start; gap: 10px; margin-top: 15px;">
        <img src="media/kenya.png" alt="Kenya" style="width: 40%; height: auto;">
        <p style="margin: 0;">
          Former Chief Justice David Maraga captured the moment: <em>"The greatness of any nation lies in its fidelity to the constitution and adherence to the rule of law."</em> President William Ruto, elected in 2022, has pledged to respect judicial independence, but the judiciary remains under pressure from political elites wary of its assertiveness. </p>
        </p>
      </div>
    </div>

    <div class="slide" data-country="Tunisia">
      <h2>Tunisia</h2>
      <h3>
        <a href="https://www.reuters.com/world/africa/tunisia-president-rejects-interference-after-western-concerns-about-democracy-2022-07-29/" target="_blank">
          North Africa: Tunisia’s Backslide</a>
      </h3>
      <div style="display: flex; align-items: flex-start; gap: 10px; margin-top: 15px;">
        <img src="media/tunisia.png" alt="Tunisia" style="width: 25%; height: auto;">
        <p style="margin: 0;">
         Tunisia’s democratic gains after the Arab Spring have steadily unraveled under President Kais Saied. Beginning in mid-2021, Saied invoked emergency powers to dissolve parliament, rule by decree, and curtail press freedom.   </p>
      </div>
      <p> <br> In July 2022, President Kais Saied defiantly stated, <i>“I reject any form of foreign interference,”</i> as he dismantled independent oversight bodies and barred key media outlets from reporting on dissent. With elections delayed indefinitely and civic space shrinking, Tunisia may no longer serve as the transition model it once did.</p> 
    </div>
    <div class="slide" data-country="Nigeria">
      <h2>Nigeria</h2>
      <h3>
        <a href="https://businessday.ng/opinion/article/mass-defections-to-apc-what-it-means-for-nigerias-democracy/" target="_blank">
        Nigeria: Toward One-Party Dominance?</a> </h3>
      <p>Nigeria's democracy exhibits a complex interplay of institutional continuity, political dominance, and emerging challenges to civil liberties. While Nigeria maintains formal democratic structures, challenges such as concentrated political power, restrictions on civil liberties, and persistent corruption pose significant threats to the health of its democracy.</p>
      <div style="display: flex; align-items: flex-start; gap: 10px; margin-top: 15px;">
        <img src="media/nigeria.png" alt="nigeria" style="width: 25%; height: auto;">
        <p style="margin: 0;">
        Africa’s largest democracy has also shown worrisome signs of consolidation. Since 2015, the All Progressives Congress (APC) has leveraged its national reach to suspend opposition governments at the state level, enact restrictive political-party laws, and pressure defectors to switch sides—raising alarms of a de facto one-party state. Political analyst Isaac Asabor sums it up: <i>If claims that the APC is monetizing defection are true, then Nigeria’s democracy is on a dangerous path.</i> (Pictured Nigerian President Bola Tinubu ) </p>
      </div>
      
    </div>
  </div>

  <div class="legend">
    <div class="legend-item"><span class="color-box liberal"></span> Liberal democracy</div>
    <div class="legend-item"><span class="color-box electoral-democracy"></span> Electoral democracy</div>
    <div class="legend-item"><span class="color-box ed-lower-bound"></span> Electoral dem. Lower Bound</div>
    <div class="legend-item"><span class="color-box ea-upper-bound"></span> Electoral Aut. Upper Bound</div>
    <div class="legend-item"><span class="color-box electoral-autocracy"></span> Electoral autocracy</div>
    <div class="legend-item"><span class="color-box closed-autocracy"></span> Closed autocracy</div>
  </div>

  <script src="mobile_menu_toggle.js"></script>
  <script>
    const map = new maplibregl.Map({
      container: 'map',
      style: {
        version: 8,
        sources: {
          'raster-tiles': {
            type: 'raster',
            tiles: [
              'https://a.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png'],
            tileSize: 256,
            attribution: '© OpenStreetMap contributors, © CartoDB'
          }
        },
        layers: [
          {
            id: 'simple-tiles',
            type: 'raster',
            source: 'raster-tiles',
            minzoom: 0,
            maxzoom: 22
          }
        ]
      },
      center: [20, 0],    // Centered on Africa
      zoom: 3.5          
    });
    const AfricaBox = [-18, -35, 52, 38]; // [west, south, east, north]


    // Add zoom and rotation controls to the map.
    map.addControl(new maplibregl.NavigationControl({
      visualizePitch: true,
      visualizeRoll: true,
      showZoom: true,
      showCompass: true
    }));

    let geoData = null;
    let currentIndex = 0;
    const slides = document.querySelectorAll('.slide');

    map.on('load', () => {
      fetch('data/democracy.geojson')
        .then(res => res.json())
        .then(data => {
          geoData = data;

          map.addSource('democracy', {
            type: 'geojson',
            data: geoData
          });

          map.addLayer({
            id: 'country-fill',
            type: 'fill',
            source: 'democracy',
            paint: {
              'fill-color': [
                'match', ['get', 'Democracy_'],
                'LD', '#756e91',
                'LD-', '#756e91',
                'ED', '#b0b1cb',
                'ED+', '#b0b1cb',
                'ED-', '#DEBFD0',
                'EA+', '#D7BDA0',
                'EA', '#bd7262',
                'CA', '#ac4f3b',
                '#e6e3e3' // default color for other values
              ],
              'fill-opacity': 0.9
            }
          });

          map.addLayer({
            id: 'country-border',
            type: 'line',
            source: 'democracy',
            paint: {
              'line-color': '#e6e6e6',
              'line-width': 0.5
            }
          });

          map.addLayer({
            id: 'highlight',
            type: 'line',
            source: 'democracy',
            paint: {
              'line-color': '#e6e6e6',
              'line-width': 4
            },
            filter: ['==', 'COUNTRY', '']
          });

          updateSlide(0);
        });
    });


    function updateSlide(index) {
      if (!geoData || index < 0 || index >= slides.length) return;

      slides.forEach((slide, i) => {
        slide.classList.toggle('active', i === index);
      });

      const country = slides[index].dataset.country;
      currentIndex = index;

      // If it's the "Global" slide, show Africa bounding box & clear highlight
      if (country === "Global") {
        const AfricaBox = [-18, -35, 52, 38];
        const containerWidth = document.getElementById('story').clientWidth;
        const offsetX = containerWidth / 4;
        const offsetY = 0;

        map.setFilter('highlight', ['==', 'COUNTRY', '']); // clear highlight

        map.fitBounds(AfricaBox, {
          padding: 100,
          duration: 1200,
          offset: [offsetX, offsetY]
        });
        return;
      }

      // For other countries: highlight and zoom to the country polygon
      map.setFilter('highlight', ['==', 'COUNTRY', country]);

      const feature = geoData.features.find(f => f.properties.COUNTRY === country);
      if (!feature || !feature.geometry) {
        console.warn("Country not found in geoData:", country);
        return;
      }

      try {
        const bbox = turf.bbox(feature);

        const containerWidth = document.getElementById('story').clientWidth;
        const offsetX = containerWidth / 4;
        const offsetY = 0;

        map.fitBounds(bbox, {
          padding: 100,
          duration: 1200,
          offset: [offsetX, offsetY]
        });
      } catch (err) {
        console.warn('Could not fly to', country, err);
      }
    }


      document.addEventListener('keydown', (e) => {
        if (e.key === 'ArrowDown') {
          e.preventDefault();
          let next = currentIndex + 1;
          if (next >= slides.length) {
            next = 0;          
          }
          updateSlide(next);
        } else if (e.key === 'ArrowUp') {
          e.preventDefault();
          let prev = currentIndex - 1;
          if (prev < 0) {
            prev = slides.length - 1; 
          }
          updateSlide(prev);
        }
      });
  </script>
</body>

</html>
